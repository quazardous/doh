# INITDEV.md Generation Guide

## Purpose
INITDEV.md is the **primary developer documentation** generated by the Kitchen system. It provides complete setup instructions for the generated development environment.

## Required Sections for INITDEV.md

### 1. Stack Configuration
- List all detected/configured technologies with versions
- Backend, Frontend, Database, Proxy, Process Manager

### 2. Quick Start (CRITICAL)
**MUST include the correct command sequence:**

```bash
# 1. Initialize environment config (creates docker-compose.env)
make env-config

# 2. Setup SSL certificates (first time only)
make ssl-setup

# 3. Build containers with proper UID/GID
export UID && export GID=$(id -g) && docker compose --env-file docker-compose.env build

# 4. Start containers
export UID && export GID=$(id -g) && docker compose --env-file docker-compose.env up -d

# 5. Install dependencies (post-build)
make dev-setup

# 6. Initialize framework (if needed)
make django-init  # or symfony-new, laravel-new, etc.

# 7. Access services URLs
```

### 3. UID/GID Configuration (MANDATORY)
**Explain clearly:**
- **WHY**: Prevents permission issues with mounted volumes
- **WHEN**: Before EVERY docker compose command
- **HOW**: `export UID && export GID=$(id -g)`
- **WHAT**: Matches container user to host user

### 4. Project Structure
Show the generated directory layout with explanations

### 5. Available Commands
List all Makefile targets with descriptions

### 6. Development Workflow
Framework-specific commands for common tasks:
- Creating new components
- Running migrations
- Managing dependencies
- Testing

### 7. Configuration Files (CRITICAL)

#### docker-compose.env
**MUST document:**
- Created by `make env-config` from `docker-compose.env-docker`
- Contains `CONTAINER_DIR=./docker` (critical for Makefile)
- All port configurations
- Database credentials
- Framework identification variables

**Example:**
```bash
# Container directory (CRITICAL for Makefile targets)
CONTAINER_DIR=./docker

# Project identification
PROJECT_NAME=myproject
APP_CONTAINER=myproject_app_1

# Ports
EXTERNAL_HTTP_PORT=8080
EXTERNAL_HTTPS_PORT=8443
```

#### Application .env
- Created by `make env-config` from `.env-docker`
- Application-specific environment variables
- Database URLs, API keys, debug settings

### 8. Troubleshooting (MANDATORY)

#### Permission Issues
```bash
# Always export UID/GID
export UID && export GID=$(id -g)
docker compose build --no-cache
```

#### CONTAINER_DIR not found
```bash
# Ensure docker-compose.env exists
make env-config
cat docker-compose.env | grep CONTAINER_DIR

# Manual override if needed
CONTAINER_DIR=./docker make ssl-setup
```

#### Port Conflicts
How to modify ports in docker-compose.env

#### SSL Certificate Issues
```bash
make ssl-cleanup
make ssl-setup
```

### 9. Kitchen Validation
Three-phase validation commands:
- Phase 0: Container connectivity
- Phase 1: Framework functionality
- Phase 2: DOH validation hash

### 10. Notes
- Dependencies installed post-build for flexibility
- Supervisor config location
- Log directories
- Data persistence

## What NOT to Include in INITDEV.md

These belong in other documentation:

### DOH Kitchen System Details → README.md
- How the Kitchen works
- Template structure
- @AI-Kitchen pseudo-tags
- Kitchen philosophy

### Docker Best Practices → DOCKER.md
- General Docker patterns
- UID/GID technical details
- User naming conventions
- Multi-stage build strategies

### Framework Detection → DETECT.md
- Detection algorithms
- File pattern analysis
- Confidence scoring

### Template Placeholders → PLACEHOLDERS.md
- Available placeholders
- Substitution rules

## Key Principles

1. **INITDEV.md is for developers using the generated environment**
2. **Must be self-contained** - developers shouldn't need other docs
3. **Focus on practical usage** - commands, not theory
4. **Include all critical warnings** - especially UID/GID and CONTAINER_DIR
5. **Framework-specific** - tailor to the detected/configured stack

## Generation Checklist

When generating INITDEV.md, verify:

- [ ] Quick Start has correct command order
- [ ] UID/GID export is emphasized multiple times
- [ ] docker-compose.env creation is explained
- [ ] CONTAINER_DIR variable is documented
- [ ] All service URLs are listed
- [ ] Troubleshooting covers common issues
- [ ] Framework-specific commands are included
- [ ] File paths match actual generated structure

## Example Structure

```markdown
# Project Name - Development Environment

## Stack Configuration
- Backend: Django 4.2
- Frontend: Vue.js 3
- Database: MariaDB 11.2
- ...

## Quick Start
[Correct command sequence with UID/GID exports]

## Important: UID/GID Configuration
[Clear explanation of why/when/how]

## Project Structure
[Generated directory tree]

## Available Commands
[make help output]

## Development Workflow
[Framework-specific tasks]

## Configuration Files
[docker-compose.env and .env documentation]

## Troubleshooting
[Common issues and solutions]

## Kitchen Validation
[Test commands]

## Notes
[Additional information]
```

This ensures developers have everything they need to successfully use the generated environment.