# T104 - Refactor T103 File Organization

**Status**: PROPOSED  
**Priority**: MEDIUM  
**Dependencies**: T103 (Intelligent Linting Feedback System) ✅ COMPLETED  
**Epic**: E098 (DOH Linting System Perfection)

Reorganize T103 implementation files to follow DOH project structure standards, separating executable scripts from data/configuration files for better maintainability and clarity.

## Problem Statement

T103 implementation currently places all files in `.claude/linting/`:
- Scripts mixed with data files
- Non-standard location for executable tools
- Configuration and logs in same directory as executables

## Proposed Solution

### **New File Organization**

```
dev-tools/
├── scripts/
│   ├── lint-files.sh              # Existing unified linting backend
│   ├── smart-lint.sh              # T103 main interface (moved from .claude)
│   ├── analyze-patterns.sh        # Pattern analysis tool (moved)
│   ├── plugin-proposals.sh        # Proposal system (moved)
│   └── linting-integration.sh     # Integration hooks (renamed from integration-hook.sh)
│
linting/                            # New top-level directory for linting data
├── data/
│   ├── manual-interventions.jsonl # Learning data
│   ├── .intervention-counter       # Internal counter
│   ├── approved-plugins.json      # Approved proposals
│   ├── rejected-plugins.json      # Rejected proposals  
│   └── proposed-plugins.json      # Proposal history
├── config/
│   └── thresholds.conf            # Configuration values (extracted from scripts)
└── README.md                      # Quick start guide pointing to full docs
│
docs/
└── linting-intelligence.md        # Full linting system documentation (comprehensive guide)
```

### **Benefits of Reorganization**

1. **Separation of Concerns**:
   - Executable scripts in `dev-tools/scripts/`
   - Data files in `linting/data/`
   - Configuration in `linting/config/`
   - Quick start guide in `linting/README.md`
   - Full documentation in `docs/linting-intelligence.md`

2. **Standard DOH Structure**:
   - Follows existing `dev-tools/` pattern
   - Creates logical `linting/` directory for all linting-related data
   - Cleaner project root organization

3. **Maintainability**:
   - Scripts can be updated without touching data
   - Data backups dont include executables
   - Clear separation between code and configuration

## Implementation Tasks

### **Phase 1: Directory Structure**

- [ ] Create `linting/` directory structure
- [ ] Create `linting/data/` for JSONL and JSON files
- [ ] Create `linting/config/` for configuration
- [ ] Create quick start `linting/README.md`

### **Phase 2: Script Migration**

- [ ] Move `smart-lint.sh` → `dev-tools/scripts/smart-lint.sh`
- [ ] Move `analyze-patterns.sh` → `dev-tools/scripts/analyze-patterns.sh`
- [ ] Move `plugin-proposals.sh` → `dev-tools/scripts/plugin-proposals.sh`
- [ ] Move `integration-hook.sh` → `dev-tools/scripts/linting-integration.sh`

### **Phase 3: Data Migration**

- [ ] Move `manual-interventions.jsonl` → `linting/data/`
- [ ] Move all JSON files → `linting/data/`
- [ ] Move `.intervention-counter` → `linting/data/`

### **Phase 4: Documentation**

- [ ] Create `linting/README.md` with quick start guide
- [ ] Move full documentation to `docs/linting-intelligence.md`
- [ ] Add links between quick start and full docs
- [ ] Update references in existing documentation

### **Phase 5: Path Updates**

- [ ] Update all scripts to use new data paths (`../../linting/data/`)
- [ ] Update integration points in `lint-files.sh`
- [ ] Update documentation with new paths
- [ ] Test all functionality with new structure

### **Phase 6: Configuration Extraction**

- [ ] Extract configuration values to `linting/config/thresholds.conf`:
  - `MIN_OCCURRENCES=5`
  - `HIGH_POTENTIAL_ONLY=true`
  - `PROPOSAL_COOLDOWN=7`
  - `CHECK_PROPOSALS_EVERY=10`
- [ ] Update scripts to source configuration file
- [ ] Document configuration options

## Migration Script

Create migration script to preserve existing data:

```bash
#\!/bin/bash
# migrate-t103-structure.sh

# Create new structure
mkdir -p linting/{data,config,docs}

# Move data files if they exist
[[ -f .claude/linting/manual-interventions.jsonl ]] && \
  mv .claude/linting/manual-interventions.jsonl linting/data/

# Move scripts to dev-tools
mv .claude/linting/*.sh dev-tools/scripts/

# Update paths in scripts
sed -i 's|\.claude/linting|linting/data|g' dev-tools/scripts/*.sh

echo "✅ T103 file structure migration complete"
```

## Success Criteria

- ✅ All scripts functional in new locations
- ✅ Data preserved and accessible
- ✅ Documentation updated with new paths
- ✅ Integration with existing linting workflow maintained
- ✅ Clean separation between code, data, and configuration

## Expected Benefits

### **For Development**
- **Cleaner structure** - Standard DOH organization patterns
- **Easier maintenance** - Clear separation of concerns
- **Better discoverability** - Scripts in expected location

### **For Operations**
- **Simpler backups** - Data separate from code
- **Configuration management** - Centralized settings
- **Version control** - Better diff visibility

### **For Documentation**
- **Logical organization** - Full docs in `docs/`, quick start in `linting/`
- **Clear references** - Predictable file locations
- **Easier onboarding** - Standard structure
- **Naming convention** - Generic names, not task-specific

## Deliverable

Refactored T103 implementation with:
- Scripts in `dev-tools/scripts/`
- Data in `linting/data/`
- Configuration in `linting/config/`
- Documentation in `linting/docs/`
- Full functionality preserved
- Migration script for existing installations
