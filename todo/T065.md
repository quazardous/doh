# T065 - Beautify /doh-sys Commands with Dynamic Flag Auto-completion & Help ğŸŒŸ

**Status**: POSTPONED  
**Priority**: MEDIUM - Developer Experience Enhancement  
**Dependencies**: None (standalone UX improvement)  
**Epic**: E001 DOH Version 1.4.0 Release - Phase 3  
**Tags**: `#ux` `#features` `#auto-completion` `#help` `#beautification`  
**Estimated Effort**: 2-3 hours  
**Created**: 2025-08-28  
**Proposed Version**: 1.5.0

## â³ Postponement Note

**Reason**: Auto-completion feature not working as expected in Claude Code environment  
**Decision Date**: 2025-08-28  
**Moved to**: Version 1.5.0  
**Status**: Feature design complete, implementation postponed for future version

## ğŸ“‹ Description

Enhance all `/doh-sys` commands with beautiful, intelligent auto-completion that dynamically shows available flags,
contextual help, and usage examples while the user is typing. This creates a modern CLI experience with immediate
feedback and guidance.

## ğŸ¯ Problem Statement

Currently, users must remember command flags or consult `--help` separately:

**Current Experience**:

- Users type `/doh-sys:commit` and guess at available flags
- No visual feedback about available options while typing
- Must run separate `--help` command to see usage
- No contextual suggestions based on current project state

**Target Experience**:

- Dynamic flag suggestions appear as user types
- Contextual help shows immediately without breaking flow
- Smart suggestions based on project state (e.g., suggest `--split` when many files are staged)
- Beautiful, organized display of options and descriptions

## Core Functionality

### 1. Dynamic Flag Auto-completion

Real-time display of available flags as user types:

#### Auto-completion Trigger

```bash
/doh-sys:commit --<TAB>
# Shows:
â”Œâ”€ Available Flags â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ --split              Split into semantic commits â”‚
â”‚ --interactive        Review each commit          â”‚
â”‚ --staged-focused     Focus on staged files       â”‚
â”‚ --no-lint           Skip linting                 â”‚
â”‚ --no-version-bump   Skip version bumping         â”‚
â”‚ --dry-run           Preview without executing    â”‚
â”‚ --amend             Amend previous commit        â”‚
â”‚ --force             Override safety checks       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Context-Aware Suggestions

```bash
# When many files are staged
/doh-sys:commit
# Shows suggestion box:
ğŸ’¡ Suggestion: Many files staged (15). Consider --split for semantic commits
   Usage: /doh-sys:commit --split

# When working directory is clean
/doh-sys:commit
# Shows:
â„¹ï¸  Working directory clean. Nothing to commit.
```

### 2. Inline Help Display

Show contextual help without breaking command flow:

#### Flag Descriptions

```bash
/doh-sys:next --context=<TAB>
# Shows:
â”Œâ”€ Context Options â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ docs        Documentation and writing tasks    â”‚
â”‚ build       Build system and architecture      â”‚
â”‚ testing     Testing and QA tasks              â”‚
â”‚ features    Core functionality development     â”‚
â”‚ quick       Tasks under 2 hours               â”‚
â”‚ blocked     Currently blocking other tasks    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Usage Examples

```bash
/doh-sys:commit --split<SPACE>
# Shows quick help:
ğŸ’¡ --split: Creates multiple focused commits
   Example: /doh-sys:commit --split --interactive
   Tip: Use --staged-focused to ignore unrelated files
```

### 3. Command State Awareness

Provide smart suggestions based on current git/project state:

#### Git State Detection

```bash
/doh-sys:commit
# Analyzes git state and shows relevant suggestions:

# If staging area is large:
ğŸ¯ Smart Suggestion: 15 files staged â†’ Consider --split

# If previous commit not pushed:
ğŸ’¡ Smart Suggestion: Unpushed commit detected â†’ Consider --amend

# If linting issues exist:
âš ï¸  Smart Suggestion: Linting issues found â†’ Use --no-lint or fix first
```

#### Project Context

```bash
/doh-sys:next
# Analyzes current project state:
ğŸ“Š Project Context: 5 ready tasks, 2 blocked, epic progress at 18%
ğŸ’¡ Suggestions: Try --context=quick for fast wins, or "version 1.4" for epic work
```

## Tasks

### Phase 1: Auto-completion Engine (1h)

- [ ] **Design completion trigger system** for detecting partial flag input
- [ ] **Create flag database** for all /doh-sys commands with descriptions
- [ ] **Implement dynamic suggestion display** with beautiful formatting
- [ ] **Add context-aware filtering** based on typed characters

### Phase 2: Contextual Help System (1h)

- [ ] **Build inline help display** that shows without breaking command flow
- [ ] **Create usage example database** for common flag combinations
- [ ] **Implement smart suggestions** based on git and project state
- [ ] **Add tip system** for advanced usage patterns

### Phase 3: Command Integration (45min)

- [ ] **Integrate with all /doh-sys commands** (commit, next, changelog, lint)
- [ ] **Add command-specific logic** for contextual suggestions
- [ ] **Create unified help formatting** across all commands
- [ ] **Add keyboard navigation** for selecting suggestions

### Phase 4: Polish & Enhancement (15min)

- [ ] **Add color coding** and beautiful formatting
- [ ] **Implement suggestion ranking** based on relevance and usage patterns
- [ ] **Add quick keyboard shortcuts** for common combinations
- [ ] **Create help overlay** for discovering features

## Technical Implementation

### Auto-completion Architecture

```bash
# Enhanced command parsing with completion support
parse_command_with_completion() {
    local cmd="$1"
    local partial_input="$2"

    # Detect completion trigger (TAB, partial flag, etc.)
    if [[ "$partial_input" =~ --[a-z-]*$ ]]; then
        show_flag_completion "$cmd" "$partial_input"
    elif [[ "$partial_input" =~ --[a-z-]+=$ ]]; then
        show_value_completion "$cmd" "$partial_input"
    else
        show_smart_suggestions "$cmd"
    fi
}
```

### Flag Database Structure

```json
{
  "doh-sys:commit": {
    "flags": {
      "--split": {
        "description": "Split into semantic commits",
        "category": "Smart Features",
        "examples": ["--split", "--split --interactive"],
        "smart_trigger": "many_staged_files",
        "help_text": "Automatically creates focused commits: Epic â†’ System â†’ Docs â†’ Implementation"
      },
      "--interactive": {
        "description": "Review each commit",
        "category": "User Control",
        "requires": ["--split"],
        "examples": ["--split --interactive"],
        "help_text": "Prompts for confirmation on each commit in sequence"
      }
    }
  }
}
```

### Smart Suggestion Logic

```bash
generate_smart_suggestions() {
    local cmd="$1"
    local suggestions=""

    # Git state analysis
    local staged_count=$(git diff --cached --name-only | wc -l)
    if [[ $staged_count -gt 5 ]]; then
        suggestions+="ğŸ’¡ Many files staged ($staged_count) â†’ Consider --split\n"
    fi

    # Previous commit analysis
    if git log --oneline -1 | grep -v origin/; then
        suggestions+="ğŸ’¡ Unpushed commit detected â†’ Consider --amend\n"
    fi

    # Project context analysis
    local ready_tasks=$(grep -c "Status.*READY" todo/*.md 2>/dev/null || echo 0)
    if [[ $ready_tasks -gt 3 ]]; then
        suggestions+="ğŸ“Š $ready_tasks ready tasks â†’ Try /doh-sys:next\n"
    fi

    echo -e "$suggestions"
}
```

### Beautiful Display Formatting

```bash
show_completion_box() {
    local title="$1"
    local items="$2"
    local width=50

    echo "â”Œâ”€ $title $(printf '%*s' $((width - ${#title} - 3)) '' | tr ' ' 'â”€')â”"

    while IFS= read -r item; do
        local flag=$(echo "$item" | cut -d'|' -f1)
        local desc=$(echo "$item" | cut -d'|' -f2)
        printf "â”‚ %-20s %s%*sâ”‚\n" "$flag" "$desc" $((width - 22 - ${#desc})) ""
    done <<< "$items"

    echo "â””$(printf '%*s' $((width + 1)) '' | tr ' ' 'â”€')â”˜"
}
```

## Enhanced Command Examples

### /doh-sys:commit with Auto-completion

```bash
# User starts typing
$ /doh-sys:commit --<TAB>

â”Œâ”€ Available Flags â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ --split              ğŸ¯ Split semantic commits    â”‚
â”‚ --interactive        ğŸ‘¤ Review each commit        â”‚
â”‚ --staged-focused     ğŸ¯ Focus staged files        â”‚
â”‚ --no-lint           âš¡ Skip linting              â”‚
â”‚ --dry-run           ğŸ‘ï¸  Preview mode              â”‚
â”‚ --amend             âœï¸  Amend previous commit     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ’¡ Smart Suggestions:
   â€¢ 12 files staged â†’ --split recommended
   â€¢ Linting enabled â†’ --no-lint available if needed

# User continues typing
$ /doh-sys:commit --split<SPACE>

ğŸ’¡ --split: Creates focused commits (Epic â†’ System â†’ Docs â†’ Code)
   ğŸ”— Combine with: --interactive (review each), --staged-focused (ignore unrelated)
   ğŸ“– Example: /doh-sys:commit --split --interactive
```

### /doh-sys:next with Context Help

```bash
# User requests help
$ /doh-sys:next --context=<TAB>

â”Œâ”€ Context Filters â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ docs        ğŸ“ Documentation tasks             â”‚
â”‚ build       ğŸ—ï¸  Build system work              â”‚
â”‚ testing     ğŸ§ª Testing and QA                 â”‚
â”‚ features    âš¡ Core functionality             â”‚
â”‚ quick       âš¡ Under 2 hours                 â”‚
â”‚ blocked     ğŸš« Blocking other work            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ“Š Current Project State:
   â€¢ 5 tasks ready in 'docs' context
   â€¢ 2 tasks ready in 'quick' context
   â€¢ 1 task ready in 'features' context
```

### /doh-sys:changelog with Smart Detection

```bash
$ /doh-sys:changelog<SPACE>

ğŸ¯ Smart Detection:
   â€¢ T064 marked COMPLETED â†’ Auto-suggest T064 changelog
   â€¢ Multiple task updates â†’ Consider batch changelog

ğŸ’¡ Quick Actions:
   â€¢ /doh-sys:changelog T064 (detected completion)
   â€¢ /doh-sys:changelog --batch (multiple updates)
   â€¢ /doh-sys:changelog --dry-run (preview changes)
```

## User Experience Scenarios

### Scenario 1: New User Discovery

```bash
# User types command without knowing flags
$ /doh-sys:commit

ğŸŒŸ Welcome! Available options:
â”Œâ”€ Popular Flags â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ --split              ğŸ¯ Smart commit splitting   â”‚
â”‚ --dry-run           ğŸ‘ï¸  Preview before commit    â”‚
â”‚ --help              â“ Full documentation       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Press TAB after -- to see all flags
Type --help for complete documentation
```

### Scenario 2: Advanced User Efficiency

```bash
# Power user gets contextual suggestions
$ /doh-sys:next --c<TAB>

â”Œâ”€ Matching Flags â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ --context=<filter>   ğŸ¯ Filter by context        â”‚
â”‚ --cache-only        âš¡ Ultra-fast memory mode   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

$ /doh-sys:next --context=qu<TAB>
â†’ Completes to: --context=quick

ğŸ’¡ --context=quick: Tasks under 2 hours
   ğŸ“Š Found: 3 quick wins available
```

### Scenario 3: Error Prevention

```bash
# User tries invalid combination
$ /doh-sys:commit --amend --split

âš ï¸  Flag Conflict Detected:
   --amend and --split cannot be used together

   Choose one:
   â€¢ --amend: Modify previous commit
   â€¢ --split: Create multiple new commits
```

## Success Criteria

- [ ] **Dynamic auto-completion** works for all /doh-sys commands
- [ ] **Contextual suggestions** appear based on git/project state
- [ ] **Beautiful formatting** with colors, icons, and organized layout
- [ ] **Smart conflict detection** prevents invalid flag combinations
- [ ] **Keyboard navigation** allows efficient flag selection
- [ ] **Performance** maintains <100ms response time for suggestions

## Benefits & Impact

- **Discoverability**: Users discover advanced features naturally
- **Efficiency**: Faster command composition with fewer errors
- **Learning Curve**: New users learn flags through guided experience
- **Professional Feel**: Modern CLI experience matching best practices
- **Reduced Documentation Lookups**: Inline help reduces context switching

## Integration Points

- **Enhances**: All existing /doh-sys commands without breaking changes
- **Complements**: T061 natural language router for unified UX
- **Builds on**: T064 --split functionality with better discoverability
- **Enables**: Advanced workflow patterns through guided discovery

## Files to Create/Update (Using Claude Code's Native Approach)

### Files to Update - Add Native Claude Code Frontmatter

#### 1. Existing Command Files (Add Claude Code completion metadata)

- **`.claude/commands/doh-sys/commit.md`** - Add `argument-hint` and `description` frontmatter
- **`.claude/commands/doh-sys/next.md`** - Add context completion hints
- **`.claude/commands/doh-sys/changelog.md`** - Add task ID completion hints
- **`.claude/commands/doh-sys/lint.md`** - Add linting option hints

#### 2. Enhanced Command Variants (New)

- **`.claude/commands/commit-split.md`** - Shortcut for `doh-sys:commit --split`
- **`.claude/commands/commit-interactive.md`** - Shortcut for `doh-sys:commit --split --interactive`
- **`.claude/commands/next-quick.md`** - Shortcut for `doh-sys:next --context=quick`
- **`.claude/commands/next-docs.md`** - Shortcut for `doh-sys:next --context=docs`

### Official Claude Code Command Structure

Based on existing DOH commands and Claude Code patterns, each command follows this structure:

````markdown
# /command-name - Brief Description

Detailed description of what the command does and its purpose.

## Usage

```bash
/command-name [arguments] [--flags]
```
````

## Parameters

- `argument`: Description of argument
- `--flag`: Description of flag

[Rest of documentation...]

```

**Current DOH Pattern**: All existing `/doh-sys:*` and `/doh:*` commands follow this markdown-only format without frontmatter, suggesting this is the established pattern for this project.

## File Structure Overview (Native Claude Code Approach)

```

.claude/ â”œâ”€â”€ commands/ â”‚ â”œâ”€â”€ doh-sys/ â”‚ â”‚ â”œâ”€â”€ commit.md (+ native frontmatter) â”‚ â”‚ â”œâ”€â”€ next.md (+ native frontmatter)  
â”‚ â”‚ â”œâ”€â”€ changelog.md (+ native frontmatter) â”‚ â”‚ â””â”€â”€ lint.md (+ native frontmatter) â”‚ â”‚ â”‚ â”œâ”€â”€ doh/ (existing runtime
commands) â”‚ â”‚ â”‚ â”œâ”€â”€ commit-split.md (NEW - shortcut command) â”‚ â”œâ”€â”€ commit-interactive.md (NEW - shortcut command) â”‚ â”œâ”€â”€
next-quick.md (NEW - shortcut command) â”‚ â”œâ”€â”€ next-docs.md (NEW - shortcut command) â”‚ â””â”€â”€ next-features.md (NEW -
shortcut command) â”‚ â””â”€â”€ doh/ â”œâ”€â”€ templates/ â”‚ â””â”€â”€ command_template.md (+ frontmatter template) â”‚ â””â”€â”€ inclaude.md (+
shortcut documentation)

```

**Key Benefits of Official Approach:**
- âœ… Follows exact DOH project patterns (consistency with existing commands)
- âœ… Pure markdown documentation - no complex frontmatter
- âœ… Claude interprets usage patterns from structured documentation
- âœ… Shortcut commands for common workflows
- âœ… Maintains compatibility with existing DOH command architecture

## Implementation Strategy (Following DOH Patterns)

**Documentation-Based**: Claude Code interprets well-structured markdown to provide intelligent completions and suggestions. The existing DOH commands demonstrate this pattern works effectively.

**Enhanced Documentation**: Add comprehensive usage examples and flag descriptions that Claude can parse for auto-completion.

**Shortcut Commands**: Create dedicated command files for popular flag combinations, following the `/command-name.md` pattern.

**Consistent Structure**: All commands follow the exact same markdown structure as existing DOH commands for consistency.

## Implementation Notes

**Backward Compatibility**: All existing command syntax remains unchanged.

**Claude Intelligence**: Claude Code's AI interprets structured documentation to provide contextual help and suggestions.

**No Custom Scripts**: Pure markdown approach aligns with existing DOH command architecture.

**Extensibility**: New commands easily added following established patterns.

## Deliverable

Enhanced `/doh-sys` command suite with beautiful, intelligent auto-completion that displays available flags, contextual help, and smart suggestions while typing. Users get immediate feedback about available options, usage examples, and project-specific recommendations, creating a modern, discoverable CLI experience that reduces learning curve while increasing productivity.

This beautification transforms the command-line interface from basic text input into an interactive, helpful guide that makes advanced DOH features accessible to all users.

---
```
