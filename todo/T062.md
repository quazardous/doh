# T062 - Enhance /doh:init with Intelligent Linting Detection & Configuration 🔍

**Status**: READY  
**Priority**: HIGH - User Experience Enhancement  
**Dependencies**: T058 (COMPLETED - Optional Linting System)  
**Epic**: E074 DOH Version 1.4.0 Release - Phase 3  
**Tags**: `#features` `#runtime` `#init` `#linting` `#ux`  
**Estimated Effort**: 2-3 hours  
**Created**: 2025-08-28  
**Target Version**: 1.4.0  

## 📋 Description

Enhance the /doh:init command with intelligent linting detection and configuration capabilities, including a dedicated --linting flag for initializing or reinitializing the linting subsystem. This builds on T058's optional linting infrastructure to provide seamless project setup with smart linting integration.

## 🎯 Problem Statement

Currently /doh:init creates DOH projects but doesn't intelligently configure the optional linting system introduced in T058. Projects need manual configuration of linting settings, missing the opportunity for smart detection and setup during initialization.

**User Experience Issues**:
- No automatic detection of existing project linting tools
- Manual configuration required for .doh/config.ini linting settings
- No guidance on optimal linting scope (doh-only vs enhanced vs comprehensive)
- Missing integration with project-specific linting workflows

## Core Functionality

### 1. Intelligent Linting Detection

During /doh:init, automatically detect and analyze:

#### Existing Linting Tools
- **ESLint**: `.eslintrc*`, `eslint.config.*` files
- **Prettier**: `prettier.config.*`, `.prettierrc*` files  
- **Stylelint**: `stylelint.config.*`, `.stylelintrc*` files
- **Markdownlint**: `markdownlint.json`, `.markdownlintrc*` files
- **Package.json scripts**: `lint`, `lint:*`, `prettier`, `format` scripts

#### Project Characteristics Analysis
- **Project type**: Node.js, Python, generic, static site
- **Documentation density**: Number of .md files, docs/ folder presence  
- **DOH usage pattern**: Task-heavy, epic-focused, simple project
- **Team size indicators**: Multiple contributors, CI setup, git hooks

### 2. Smart Configuration Recommendations

Based on detection results, recommend optimal linting configuration:

#### Recommendation Logic
```
Has existing linting?
├── Yes → Suggest "doh-only" scope (respectful integration)
│   ├── Has comprehensive setup → Minimal DOH linting
│   └── Has basic setup → Enhanced DOH linting
└── No → Suggest "enhanced" or "comprehensive" scope
    ├── Documentation-heavy → Enhanced scope
    ├── Simple project → DOH-only scope  
    └── Complex project → Comprehensive scope
```

### 3. Interactive Linting Setup

Present user-friendly configuration options:

#### Setup Flow
1. **Detection Results**: Show what was found
2. **Recommendation**: Explain suggested scope and rationale
3. **User Choice**: Allow override with explanation of each option
4. **Configuration**: Generate appropriate .doh/config.ini settings
5. **Integration**: Set up any necessary project integration

## Tasks

### Phase 1: Detection Engine (45min)

- [ ] **Design detection patterns** for common linting tools and configurations
- [ ] **Implement project analysis** logic in /doh:init command
- [ ] **Create scoring system** for determining optimal linting scope
- [ ] **Add configuration recommendation** logic with clear rationale

### Phase 2: Interactive Configuration (45min)

- [ ] **Implement --linting flag** for dedicated linting setup/reinit
- [ ] **Create interactive prompts** for linting configuration
- [ ] **Add configuration validation** and preview functionality
- [ ] **Generate .doh/config.ini** with appropriate linting settings

### Phase 3: Integration & User Experience (45min)

- [ ] **Integrate with main /doh:init** flow for seamless setup
- [ ] **Add reinit capability** via /doh:init --linting for existing projects
- [ ] **Create status checking** to show current linting configuration
- [ ] **Add troubleshooting** for common linting integration issues

### Phase 4: Testing & Documentation (15min)

- [ ] **Test with various project types** and linting configurations
- [ ] **Document linting setup** in DOH runtime documentation
- [ ] **Create examples** for common project scenarios
- [ ] **Add help text** for --linting flag and options

## Technical Implementation

### Detection Algorithms

#### Linting Tool Detection
```bash
# Pseudo-code for detection logic
detect_eslint() {
    find_files(".eslintrc*", "eslint.config.*")
    check_package_json("eslint", "devDependencies")
    return confidence_score
}

detect_prettier() {
    find_files(".prettierrc*", "prettier.config.*")
    check_package_json("prettier", "devDependencies")
    check_package_scripts("prettier", "format")
    return confidence_score
}
```

#### Project Analysis
```bash
analyze_project_characteristics() {
    local doc_files=$(find . -name "*.md" | wc -l)
    local has_docs_folder=[[ -d "docs" ]]
    local git_contributors=$(git log --format="%an" | sort -u | wc -l)
    
    # Return project profile for linting recommendations
}
```

### Configuration Generation

#### .doh/config.ini Template
```ini
[pipeline]
lint_enabled = true|false           # Based on user choice
lint_scope = doh-only|enhanced|comprehensive
lint_integration = respectful       # For existing linting projects  
lint_auto_detect = true            # Future: auto-adjust based on changes

[linting]
# Generated based on detected tools and user preferences
existing_tools = eslint,prettier    # Detected tools
project_type = nodejs              # Detected project type
recommendation_rationale = "existing_comprehensive_setup"
```

### --linting Flag Implementation

#### Command Behavior
```bash
# New linting-specific initialization
/doh:init --linting
# → Runs only linting detection and configuration
# → Updates existing .doh/config.ini 
# → Shows current vs recommended settings

# Full init with linting emphasis  
/doh:init --verbose --linting
# → Standard DOH init + detailed linting setup
# → Interactive linting configuration
```

#### Reinit Capability
```bash
# Reinitialize only linting configuration
/doh:init --linting --reinit
# → Re-detect linting tools
# → Update configuration recommendations
# → Preserve other DOH settings
```

## User Experience Scenarios

### Scenario 1: New Project with Existing Linting
```
🔍 DOH Linting Setup

✅ Detected existing linting configuration:
   • ESLint (React setup)
   • Prettier (configured)
   • Package scripts: lint, lint:fix, format

💡 Recommendation: doh-only scope
   Rationale: Your project has comprehensive linting. DOH will focus on 
   .doh/ files and documentation to avoid conflicts.

Configuration:
[pipeline]
lint_enabled = true
lint_scope = doh-only
lint_integration = respectful

Apply this configuration? [Y/n/customize]:
```

### Scenario 2: New Project without Linting
```
🔍 DOH Linting Setup

ℹ️  No existing linting detected.

📊 Project analysis:
   • 12 markdown files found  
   • docs/ folder present
   • Single contributor detected

💡 Recommendation: enhanced scope
   Rationale: Documentation-heavy project would benefit from DOH's 
   markdown linting plus basic project-wide quality assurance.

This will enable:
✅ DOH task validation (.doh/ files)
✅ Markdown quality (README, docs/, *.md)
✅ Basic JSON/YAML validation

Apply enhanced linting? [Y/n/comprehensive/doh-only]:
```

### Scenario 3: Reinit Existing Project
```
🔍 DOH Linting Reconfiguration

📋 Current configuration:
   lint_enabled = false
   
🔍 Detected changes since last init:
   • New: .eslintrc.json (ESLint added)
   • New: lint script in package.json
   
💡 Updated recommendation: doh-only scope
   Previous: disabled (no linting detected)
   Current: respectful integration (ESLint detected)
   
Update configuration? [Y/n/keep-disabled]:
```

## Success Criteria

- [ ] **/doh:init detects** existing linting tools with >90% accuracy
- [ ] **Smart recommendations** match optimal configuration for project type
- [ ] **--linting flag** provides dedicated linting setup functionality  
- [ ] **Interactive configuration** is intuitive and well-explained
- [ ] **Reinit capability** works correctly for existing DOH projects
- [ ] **Documentation complete** with examples for common scenarios

## Dependencies & Integration

- **Depends on**: T058 (COMPLETED - Optional Linting System)
- **Enhances**: /doh:init command functionality 
- **Integrates with**: T002 (core commands), optional linting pipeline
- **Enables**: Seamless DOH project setup with optimal linting configuration

## Impact & Benefits

- **Seamless Setup**: Projects get optimal linting configuration automatically
- **Smart Integration**: Respects existing project tools and workflows  
- **Reduced Friction**: No manual configuration required for common scenarios
- **Professional Quality**: Even simple projects get quality assurance capabilities
- **Progressive Enhancement**: Can reconfigure as projects evolve

## Implementation Notes

**Detection Strategy**: Comprehensive but fast - scan common file patterns and package.json without deep analysis.

**User Choice Priority**: Always allow user override of recommendations with clear explanation of implications.

**Configuration Preservation**: Reinit should preserve other DOH settings while updating only linting configuration.

**Performance**: Detection should add <500ms to /doh:init execution time.

## Deliverable

Enhanced /doh:init command with intelligent linting detection, smart configuration recommendations, and dedicated --linting flag for seamless DOH project setup with optimal linting integration that respects existing project workflows while providing professional quality assurance capabilities.

---