# T059 - Port /doh-sys:next AI Task Engine to /doh Runtime ðŸ§ 

**Status**: READY  
**Priority**: HIGH - AI-Powered Project Intelligence  
**Dependencies**: T058 (Port Pipeline), T054 (Memory System COMPLETED)  
**Epic**: E001 DOH Version 1.4.0 Release - Phase 3  
**Tags**: `#features` `#runtime` `#ai` `#intelligence`  
**Estimated Effort**: 4-5 hours  
**Created**: 2025-08-28  
**Target Version**: 1.4.0  

## ðŸ“‹ Description

Port the sophisticated /doh-sys:next AI-powered task recommendation engine to the /doh runtime, enabling DOH projects to benefit from intelligent task prioritization, natural language queries, and smart memory systems for their own task management.

## ðŸŽ¯ Objectives

- **Enable /doh:next** - Full AI task analysis for DOH-managed projects
- **Adapt Memory System** - Project-specific .doh/memory/NEXT.md intelligence
- **Natural Language Queries** - "what should I work on?" for any project
- **Smart Prioritization** - Dependency analysis and impact scoring for DOH tasks
- **Performance Modes** - Standard, cache-only, and fresh analysis options

## Tasks

### Phase 1: Architecture Adaptation (1.5h)

- [ ] **Analyze /doh-sys:next** for runtime compatibility requirements
- [ ] **Design runtime memory structure** in .doh/memory/ for project tasks
- [ ] **Map task structure translation** from todo/*.md to .doh/tasks/
- [ ] **Plan Epic/PRD awareness** integration with .doh/epics/

### Phase 2: Core AI Engine Implementation (2h)

- [ ] **Port dependency analysis** for DOH task graph resolution
- [ ] **Port natural language processing** for query understanding
- [ ] **Port prioritization algorithm** with DOH-specific scoring
- [ ] **Port memory system** with .doh/memory/NEXT.md persistence

### Phase 3: Runtime-Specific Intelligence (1h)

- [ ] **Epic/PRD Integration** - Analyze epic relationships and phases
- [ ] **Multi-agent awareness** - Consider agent assignments in recommendations
- [ ] **Project context learning** - Adapt to project type (web, library, tool)
- [ ] **Team collaboration hints** - Suggest based on agent/owner patterns

### Phase 4: Testing & Documentation (30min)

- [ ] **Test on sample .doh project** with complex task dependencies
- [ ] **Validate memory persistence** across command invocations
- [ ] **Document runtime usage** in inclaude.md
- [ ] **Create example queries** for common project scenarios

## Technical Considerations

### Task Structure Mapping

**Development** (/doh-sys:next):
```
todo/T###.md files â†’ Individual task analysis
todo/NEXT.md â†’ Memory and cache
Epic references â†’ E### in tasks
```

**Runtime** (/doh:next):
```
.doh/tasks/*.json â†’ DOH task structure
.doh/epics/*.json â†’ Epic relationships  
.doh/memory/NEXT.md â†’ Project intelligence
.doh/features/*.json â†’ Feature dependencies
```

### Memory Architecture Adaptation

```
.doh/memory/
â”œâ”€â”€ NEXT.md              # AI memory for task recommendations
â”œâ”€â”€ patterns.md          # Learned project patterns
â”œâ”€â”€ preferences.md       # User preference tracking
â””â”€â”€ optimization.md      # AI optimization log
```

### Query Translation Examples

**Generic to Project-Specific**:
- "what's high impact?" â†’ Analyze DOH task dependencies
- "quick wins" â†’ Filter by effort estimates in task JSON
- "epic progress" â†’ Parse .doh/epics/ for phase completion
- "blocked tasks" â†’ Resolve depends_on fields in tasks

### AI Logic Adaptation

- **Task Parsing**: Read .doh/tasks/*.json instead of todo/*.md
- **Dependency Resolution**: Use DOH's depends_on field structure
- **Priority Calculation**: Integrate DOH priority field (P0-P3)
- **Epic Awareness**: Parse .doh/epics/ for strategic context
- **Agent Integration**: Consider assigned_to for workload distribution

### Performance Optimization

```ini
# .doh/config.ini additions
[ai]
next_cache_ttl = 300        ; Memory cache TTL in seconds
next_auto_refresh = true    ; Auto-refresh on task changes
next_default_limit = 5      ; Default recommendation count
next_memory_enabled = true  ; Enable smart memory system
```

## Success Criteria

- [ ] **/doh:next works** with natural language queries in .doh projects
- [ ] **Dependency analysis** correctly resolves DOH task relationships
- [ ] **Memory persistence** maintains project intelligence across sessions
- [ ] **Epic integration** provides strategic context in recommendations
- [ ] **Performance modes** (standard/cache/fresh) function correctly
- [ ] **Documentation complete** with usage examples and query patterns

## Dependencies & Integration

- **Depends on**: T058 (pipeline foundation), T054 (memory concepts)
- **Enhances**: Core /doh runtime intelligence
- **Integrates with**: T002 (core commands), T004 (command system)
- **Complements**: T058's pipeline with proactive recommendations

## Impact & Benefits

- **Intelligent Prioritization**: AI-driven task recommendations for every project
- **Natural Language Interface**: Conversational task discovery
- **Strategic Alignment**: Epic and PRD-aware recommendations
- **Team Coordination**: Multi-agent workload awareness
- **Continuous Learning**: Project-specific pattern recognition

## Implementation Strategy

### Reuse Approach

Maximum reuse from /doh-sys:next with context adaptation:
- Core AI algorithms remain unchanged
- Query processing logic preserved
- Memory system architecture reused
- Only data source and structure mapping changes

### Key Differences from /doh-sys

| Aspect | /doh-sys:next | /doh:next |
|--------|---------------|-----------|
| Task Source | todo/*.md files | .doh/tasks/*.json |
| Dependencies | Markdown parsing | JSON depends_on field |
| Memory Location | todo/NEXT.md | .doh/memory/NEXT.md |
| Epic Awareness | Text references | .doh/epics/ structure |
| Priority | Inferred from text | Explicit P0-P3 field |

### Progressive Enhancement

1. **MVP**: Basic task recommendations with dependency analysis
2. **Enhanced**: Natural language queries and memory system
3. **Advanced**: Epic integration and multi-agent awareness
4. **Optimal**: Project learning and pattern recognition

## Example Usage Scenarios

```bash
# Basic recommendation
/doh:next
# Returns: Top 5 DOH tasks based on priority and dependencies

# Natural language query
/doh:next "what's blocking our API development?"
# Analyzes tasks tagged with API, identifies blockers

# Epic-focused work
/doh:next "show me epic 1 phase 2 tasks"
# Filters tasks by epic assignment and phase

# Team coordination
/doh:next "what can agent-backend work on?"
# Recommends based on agent assignment and dependencies

# Quick wins
/doh:next --context=quick
# Shows tasks with effort < 2 story points

# Memory-only ultra-fast mode
/doh:next --cache-only
# Sub-100ms response from .doh/memory/NEXT.md
```

## Deliverable

Fully functional /doh:next command that brings AI-powered task intelligence to every DOH-managed project, with natural language understanding, smart memory persistence, and strategic epic awareness - transforming project task management from static lists to conversational, intelligent recommendations.

---