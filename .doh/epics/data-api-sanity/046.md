---
number: 046
epic: 024
title: Refactor workspace and version scripts (workspace.sh, version-migrate.sh)
status: pending
created: 2025-09-02T11:30:00Z
target_version: 0.7.0
file_version: 0.1.0
---

# Task 046: Refactor Workspace and Version Scripts

## Scripts to Refactor (ALL become thin wrappers):
- `workspace.sh` (top-level) → Wrapper calling `workspace_main()` from workspace.sh library
- `version-migrate.sh` → Wrapper calling `migration_migrate_version()` from migration.sh library

## Libraries to Create/Update:
- Update `workspace.sh` library - Add `workspace_main()` function for top-level operations
- Create `migration.sh` library with functions:
   - `migration_migrate_version(from_version, to_version)` - Main migration
   - `migration_backup_data([backup_dir])` - Backup before migration
   - `migration_validate_migration()` - Validate migration state
   - `migration_rollback([backup_dir])` - Rollback migration
   - `migration_get_available_migrations()` - List available migrations

## Thin Wrapper Pattern:
Each script becomes equivalent to:
- `workspace.sh` ≡ `api.sh workspace main "$@"`
- `version-migrate.sh` ≡ `api.sh migration migrate_version "$@"`

Top-level scripts delegate to library functions, maintaining clean separation.