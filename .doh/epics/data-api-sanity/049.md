---
number: 049
epic: 024
title: Audit and remove unnecessary dohenv.sh sourcing
status: pending
created: 2025-09-02T12:00:00Z
target_version: 0.7.0
file_version: 0.1.0
---

# Task 049: Audit and Remove Unnecessary dohenv.sh Sourcing

## Problem Statement
Many DOH libraries currently source `dohenv.sh` when they don't actually need it. The `dohenv.sh` library provides environment and workspace initialization functions, but most pure libraries only need basic functions from `doh.sh` and `frontmatter.sh`.

## Libraries to Audit

Check each library and remove `dohenv.sh` sourcing if not needed:

- âœ… `prd.sh` - Already removed (only needs doh.sh + frontmatter.sh)
- `task.sh` - Check if dohenv functions are used
- `file-headers.sh` - Check if dohenv functions are used
- `file-cache.sh` - Check if dohenv functions are used
- `registers.sh` - Check if dohenv functions are used
- `graph-cache.sh` - Check if dohenv functions are used
- `version.sh` - Check if dohenv functions are used
- `workspace.sh` - May legitimately need dohenv
- `numbering.sh` - Check if dohenv functions are used
- `message-queue.sh` - Check if dohenv functions are used

## Functions in dohenv.sh to Look For

Only keep dohenv.sh sourcing if the library uses:
- `dohenv_load()` - Environment initialization
- `dohenv_is_loaded()` - Environment status check
- Workspace-specific environment functions

## Most Libraries Only Need:
- `doh_find_root()` from doh.sh
- `frontmatter_get_field()` etc. from frontmatter.sh
- Other specific library functions

## Implementation Steps:
1. For each library, search for usage of dohenv_ prefixed functions
2. If no dohenv functions are used, remove the dohenv.sh sourcing line
3. Test the library still works correctly
4. Update any scripts that were incorrectly relying on dohenv via library sourcing

## Goal:
Minimize library dependencies and reduce sourcing overhead. Most libraries should only source the minimal dependencies they actually use.