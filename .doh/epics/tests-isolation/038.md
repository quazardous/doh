---
name: Research DOH_GLOBAL_DIR library consistency
description: Audit all DOH libraries to verify consistent DOH_GLOBAL_DIR usage and identify hardcoded paths
status: pending
created: 2025-09-02T15:53:24Z
target_version: 0.6.0
file_version: 0.1.0
epic: tests-isolation
---

# Task 038: Research DOH_GLOBAL_DIR library consistency

## Objective
Conduct comprehensive audit of all DOH libraries to verify that `DOH_GLOBAL_DIR` is used consistently and identify any hardcoded paths that could bypass test isolation.

## Scope
Analyze all libraries in `.claude/scripts/doh/lib/` for:
- Usage of `DOH_GLOBAL_DIR` vs hardcoded `~/.doh/` paths
- Path generation functions that need isolation support
- Functions that write/read persistent data
- Any direct filesystem operations that bypass DOH_GLOBAL_DIR

## Deliverables
- [ ] Complete audit report of `DOH_GLOBAL_DIR` usage across all libraries
- [ ] List of hardcoded paths that need fixing
- [ ] Identification of functions requiring `DOH_WORKSPACE_PROJECT_ID` special handling
- [ ] Test isolation implementation strategy based on findings

## Libraries to Audit
- workspace.sh
- numbering.sh  
- file-cache.sh
- graph-cache.sh
- registers.sh
- message-queue.sh
- dohenv.sh
- version.sh
- frontmatter.sh
- All other libraries with file operations

## Success Criteria
- All file operations traced to their root path determination
- Clear understanding of which libraries are already isolation-ready
- Specific plan for fixing any hardcoded path issues
- Validation that `DOH_GLOBAL_DIR="$(mktemp -d)"` approach will work

## Next Task Dependencies
This research informs all subsequent implementation tasks.