---
name: Add DOH_WORKSPACE_PROJECT_ID override for special cases
description: Implement project ID override for cases where GLOBAL_DOH_DIR alone is insufficient
status: pending
created: 2025-09-02T15:53:24Z
target_version: 0.6.0
file_version: 0.1.0
epic: tests-isolation
---

# Task 041: Add DOH_WORKSPACE_PROJECT_ID override for special cases

## Objective
Implement `DOH_WORKSPACE_PROJECT_ID` environment variable override for cases where predictable project IDs are needed in tests.

## Implementation
1. **Modify workspace.sh**: Add environment variable check to `workspace_get_current_project_id()`:
   ```bash
   workspace_get_current_project_id() {
       # Allow override for testing
       if [[ -n "${DOH_WORKSPACE_PROJECT_ID:-}" ]]; then
           echo "$DOH_WORKSPACE_PROJECT_ID"
           return 0
       fi
       
       # Default behavior
       local doh_root
       doh_root="$(doh_project_dir)" || return 1
       # ... existing logic
   }
   ```

2. **Test framework integration**: Optionally set predictable project ID for specific tests

3. **Documentation**: Update library header with environment variable usage

## Use Cases
- Tests requiring predictable file paths
- Cross-test data sharing scenarios  
- Debugging test isolation issues

## Success Criteria
- [ ] `DOH_WORKSPACE_PROJECT_ID` overrides default project ID calculation
- [ ] Tests can set predictable project identifiers
- [ ] Default behavior unchanged when variable not set
- [ ] Integration with test framework isolation

## Dependencies
- Task 038: Research findings
- Task 039: Function naming standardization