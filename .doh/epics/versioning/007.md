---
name: Version milestone conditions and auto-bump
number: 007
status: completed
created: 2025-08-31T16:10:00Z
updated: 2025-09-01T22:55:00Z
github: [Will be updated when synced to GitHub]
epic: versioning
depends_on: [006]
parallel: false
conflicts_with: []
file_version: 0.1.0
---

# Task: Version milestone conditions and auto-bump

## Description
Implement a system for defining version milestone conditions in version description files, allowing automatic version bump proposals when tasks are completed. This creates a goal-driven version management system where version bumps are triggered by achievement of specific milestones.

## Acceptance Criteria
- [ ] Define version milestone file format with task conditions
- [ ] Implement task completion tracking against version milestones
- [ ] Create auto-bump proposal system when conditions are met
- [ ] Add validation command to check milestone progress
- [ ] Integrate with task completion workflow
- [ ] Support multiple version tracks (patch, minor, major)
- [ ] Generate milestone progress reports

## Technical Details

### Version Milestone File Format
Location: `.doh/versions/{version}.md`

```markdown
---
version: 1.1.0
status: planned
release_date: TBD
type: minor
file_version: 0.1.0
---

# Version 1.1.0 - Feature Release

## Release Conditions
Automatic bump will be proposed when ALL conditions are met:

### Required Tasks
- [ ] 005 - Create frontmatter integration
- [ ] 006 - Version bump workflow implementation
- [ ] 007 - Version milestone conditions

### Required Epics
- [ ] versioning - Core versioning system

### Optional Goals
- [ ] 80% test coverage
- [ ] Documentation complete

## Release Notes
[Will be generated from completed tasks]
```

### Implementation Components

1. **Milestone Parser**:
   ```bash
   # Parse version milestone conditions
   parse_version_milestones() {
       local version_file="$1"
       # Extract required tasks, epics, and goals
       # Return structured data
   }
   ```

2. **Condition Checker**:
   ```bash
   # Check if version conditions are met
   check_version_conditions() {
       local version="$1"
       # Check task completion status
       # Check epic completion status
       # Evaluate optional goals
       # Return true if all required conditions met
   }
   ```

3. **Auto-Bump Proposer**:
   ```bash
   # Propose version bump when conditions met
   propose_version_bump() {
       # Scan all planned version files
       # Check conditions for each
       # Propose bump for satisfied versions
   }
   ```

### Integration Points

1. **Task Completion Hook**:
   - When task marked complete, check all version milestones
   - If milestone conditions met, propose version bump
   - Show progress towards next versions

2. **Status Command Enhancement**:
   ```bash
   /doh:version-status
   
   Current Version: 1.0.0
   
   Next Patch (1.0.1): 2/3 tasks complete (66%)
   - [x] 001 - Bug fix A
   - [x] 002 - Bug fix B  
   - [ ] 003 - Bug fix C
   
   Next Minor (1.1.0): 1/3 tasks complete (33%)
   - [x] 005 - Frontmatter integration
   - [ ] 006 - Version bump workflow
   - [ ] 007 - Version milestones
   
   ðŸ’¡ Version 1.0.1 ready for release! Run: /doh:version-bump patch
   ```

3. **Validation Command**:
   ```bash
   /doh:version-validate [version]
   
   # Check specific version readiness
   # List blocking tasks/epics
   # Show completion percentage
   ```

### Workflow Integration

1. **Task Completion Flow**:
   ```
   Task Completed â†’ Check Milestones â†’ Conditions Met? 
                                         â†“ Yes
                                    Propose Bump
                                         â†“
                                    User Confirms?
                                         â†“ Yes
                                    Execute Bump
   ```

2. **Multiple Version Tracks**:
   - Track patch, minor, major versions simultaneously
   - Show progress for each track
   - Propose most appropriate bump

3. **Smart Suggestions**:
   - Analyze completed work type
   - Suggest appropriate version bump level
   - Provide release notes preview

### Data Storage

1. **Milestone Registry**:
   ```json
   {
     "versions": {
       "1.0.1": {
         "status": "planned",
         "required_tasks": ["001", "002", "003"],
         "progress": 0.66
       },
       "1.1.0": {
         "status": "planned",
         "required_tasks": ["005", "006", "007"],
         "required_epics": ["versioning"],
         "progress": 0.33
       }
     }
   }
   ```

## Dependencies
- [ ] Version bump workflow (Task 006)
- [ ] Version library functions
- [ ] Task completion tracking
- [ ] Registry system

## Effort Estimate
- Size: L
- Hours: 8-10
- Parallel: false (depends on Task 006)

## Definition of Done
- [ ] Version milestone file format defined
- [ ] Milestone parser implemented
- [ ] Condition checker working
- [ ] Auto-bump proposer functional
- [ ] Task completion integration complete
- [ ] Version status command enhanced
- [ ] Documentation with examples
- [ ] Unit tests for all components
- [ ] Integration tests for workflow