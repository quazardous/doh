---
name: Version file headers system
number: 011
status: completed
created: 2025-08-31T21:12:57Z
updated: 2025-09-01T18:45:00Z
github: [Will be updated when synced to GitHub]
epic: versioning
depends_on: []
parallel: true
conflicts_with: []
file_version: 0.1.0
---

# Task: Version file headers system

## Description
Implement automatic version header addition for new files based on file type detection. This ensures all new files in the DOH project include appropriate version information in their headers using the correct comment syntax for each language.

## Acceptance Criteria
- [x] Detect file type from extension
- [x] Add appropriate version headers for each file type
- [x] Support .sh, .md, .py, .js, .yml files
- [x] Integrate with file creation workflows
- [x] Preserve existing headers when updating
- [x] Handle files without comment syntax gracefully

## Technical Details
### File Type Support
1. **Shell Scripts (.sh)**
   ```bash
   #!/bin/bash
   # DOH Version: 0.1.0
   # Created: 2025-08-31T19:13:44Z
   ```

2. **Markdown Files (.md)**
   ```yaml
   ---
   file_version: 0.1.0
   created: 2025-08-31T19:13:44Z
   ---
   ```

3. **Python Files (.py)**
   ```python
   # DOH Version: 0.1.0
   # Created: 2025-08-31T19:13:44Z
   ```

4. **JavaScript Files (.js)**
   ```javascript
   // DOH Version: 0.1.0
   // Created: 2025-08-31T19:13:44Z
   ```

5. **YAML Files (.yml, .yaml)**
   ```yaml
   # DOH Version: 0.1.0
   # Created: 2025-08-31T19:13:44Z
   ```

### Implementation Components
1. **File Type Detection**
   - Extension-based detection
   - Shebang detection for scripts
   - MIME type fallback

2. **Header Injection**
   - Detect existing headers
   - Insert after shebang if present
   - Preserve file content integrity
   - Handle frontmatter for markdown

3. **Version Retrieval**
   - Get current version from VERSION file
   - Use ISO timestamp for creation date
   - Support custom version overrides

### Integration Points
- Hook into Write tool workflows
- Integrate with epic/task creation
- Support batch file processing
- Provide CLI command for manual use

## Dependencies
- [ ] Version library (version.sh)
- [ ] File manipulation utilities
- [ ] Frontmatter library for markdown

## Effort Estimate
- Size: M
- Hours: 6-8
- Parallel: true

## Definition of Done
- [x] File type detection working for all supported types
- [x] Headers added correctly for each file type
- [x] Existing headers preserved on update
- [x] Integration with creation workflows
- [x] Batch processing capability
- [x] Unit tests for each file type
- [x] Documentation with examples
- [x] Edge cases handled gracefully

## Implementation Notes
Implemented file header system with:
- `file-headers.sh` library with comprehensive header management functions
- `/doh:add-file-headers` command for manual and batch header addition
- Support for .sh, .md, .py, .js, .ts, .yml, .yaml file types
- Proper shebang preservation and frontmatter handling
- Batch processing for finding and updating files missing headers