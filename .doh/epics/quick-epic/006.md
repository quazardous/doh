---
id: 006
title: Add --direct flag support for bypass workflow
status: pending
created: 2025-08-31T15:05:00Z
priority: medium
estimate: 3 hours
epic: quick-epic
depends_on: [001, 002]
---

# Task 006: Add --direct flag support for bypass workflow

## Overview

Implement `--direct` flag support for the `/doh:quick` command that allows users to skip the interactive matching workflow entirely and go straight to the QUICK system. This provides a fast path for users who know their task doesn't match existing PRDs or when they want immediate task creation without analysis.

## Requirements

### Functional Requirements

#### Direct Flag Behavior
- `/doh:quick --direct "task description"` skips all matching and selection
- Immediately creates task in QUICK system without user interaction
- No PRD scanning, no match display, no confirmation prompts
- Fast path for obvious quick tasks or when time is critical
- Should complete in under 2 seconds from command to task creation

#### Command Line Integration
- Support both `--direct` and `-d` short form
- Maintain backward compatibility with existing `/doh:quick` usage
- Handle flag placement: both `/doh:quick --direct "desc"` and `/doh:quick "desc" --direct`
- Provide clear usage help that explains both modes

#### Task Creation Process
- Generate task ID following QUICK system numbering scheme
- Use standard task template with appropriate defaults
- Set priority to "medium" by default (configurable)
- Include creation timestamp and epic reference
- Apply same file naming conventions as interactive workflow

### Technical Requirements

#### Flag Processing
- Parse command line arguments to detect `--direct` or `-d` flag
- Extract task description from remaining arguments
- Validate that description is provided when using direct mode
- Handle argument parsing edge cases gracefully

#### Workflow Bypass
- Skip matching algorithm entirely (don't call Task 001 functions)
- Skip interactive selection (don't call Task 002 functions)  
- Go directly to QUICK system task creation
- Maintain logging for audit trail

#### Integration Points
- Work with existing QUICK system structure from Task 005
- Use same task creation functions as interactive workflow
- Integrate with existing DOH command error handling
- Support same output formatting as other DOH commands

## Implementation Details

### Command Line Processing
```bash
# Argument parsing logic
parse_quick_args() {
    local direct_mode=false
    local description=""
    
    while [[ $# -gt 0 ]]; do
        case $1 in
            --direct|-d)
                direct_mode=true
                shift
                ;;
            *)
                description="$description $1"
                shift
                ;;
        esac
    done
    
    # Validate and process
    if [[ $direct_mode == true ]]; then
        create_quick_task_direct "$description"
    else
        run_interactive_matching "$description"  
    fi
}
```

### Direct Creation Flow
```bash
# Streamlined task creation
create_quick_task_direct() {
    local description="$1"
    
    # Validate input
    [[ -n "$description" ]] || error "Task description required for --direct mode"
    
    # Generate task details
    local task_id=$(get_next_quick_task_id)
    local task_file=".doh/quick/${task_id}-$(slugify "$description").md"
    
    # Create task file
    create_task_file "$task_file" "$description" "QUICK" "medium"
    
    echo "‚úÖ Quick task created: $task_id"
    echo "üìç Epic: QUICK"
    echo "üìù Description: $description"
}
```

### Help Integration
- Update command help text to explain both modes
- Show examples for both interactive and direct usage
- Explain when to use each approach

### Dependencies
- Task 001: Uses same task creation functions (but skips matching)
- Task 002: Shares task file creation utilities (but skips interaction)
- Task 005: Relies on QUICK system structure being available
- Existing DOH command argument parsing patterns

## Testing Strategy

### Command Line Testing
1. **Flag Detection**: Test `--direct` and `-d` recognition
2. **Argument Order**: Test flag before and after description
3. **Combined Flags**: Ensure compatibility with other potential flags
4. **Invalid Usage**: Test missing description with --direct flag
5. **Help Display**: Verify updated help includes direct mode explanation

### Performance Testing
1. **Speed Requirement**: Verify < 2 second completion time
2. **Resource Usage**: Confirm no unnecessary PRD scanning occurs
3. **File Operations**: Test task file creation performance
4. **Error Handling**: Ensure fast failure for invalid inputs

### Integration Testing
- Direct tasks appear correctly in `/doh:next` output
- QUICK system status includes directly created tasks
- Task numbering follows proper sequence
- GitHub sync handles direct tasks correctly

### Edge Case Testing
- Empty description with --direct flag
- Very long descriptions
- Special characters in descriptions
- Concurrent direct task creation

## Acceptance Criteria

- [ ] `--direct` and `-d` flags bypass all interactive workflows
- [ ] Direct mode completes task creation in under 2 seconds
- [ ] Command line argument parsing handles all flag positions
- [ ] Error messages provide clear guidance for invalid usage
- [ ] Help text explains both interactive and direct modes with examples
- [ ] Direct tasks integrate seamlessly with existing DOH commands
- [ ] Backward compatibility maintained for existing `/doh:quick` usage
- [ ] Task file format matches interactive workflow output

## Definition of Done

- Flag parsing implemented and tested across argument variations
- Direct workflow bypasses matching and selection algorithms
- Performance requirement met (< 2 seconds completion)
- Help documentation updated with usage examples
- Integration with QUICK system structure verified
- Error handling provides clear user guidance
- All test scenarios pass including edge cases